WLBootstrap = function(){var scriptFileList = new Array('http://search.live.com/DynamicScript.js?ver=1.00','http://search.live.com/JsonRequest.js?ver=1.00','http://search.live.com/SearchBox/WLSearchBox.js?ver=1.01','http://search.live.com/SearchBox/WLSearchBoxWeb.js?ver=1.00');var totalNumber = scriptFileList.length;var loadedNumber = 0;var scriptObjectList = new Array(totalNumber);var scriptStateList = new Array(totalNumber);for (var i = 0; i < totalNumber; i++){scriptStateList[i] = new Object();scriptStateList[i].fileName = scriptFileList[i];scriptStateList[i].loadState = 'unload';}for (var i = 0; i < totalNumber; i++){scriptObjectList[i] = document.createElement('script');scriptObjectList[i].type = "text/javascript";scriptObjectList[i].src = scriptFileList[i];scriptObjectList[i].charset = "utf-8";scriptObjectList[i].onreadystatechange = new Function("ScriptObjectReadyCallback(" + i + ")");scriptObjectList[i].onload = new Function("ScriptObjectLoadCallback(" + i + ")");scriptObjectList[i].onerror = new Function("ScriptObjectErrorCallback(" + i + ")");document.getElementsByTagName('head')[0].appendChild(scriptObjectList[i]);}ScriptObjectReadyCallback = function(index){if (scriptObjectList[index].readyState == 'loaded' || scriptObjectList[index].readyState == 'complete'){scriptStateList[index].loadState = 'loaded';++loadedNumber;if (loadedNumber == totalNumber){WLSearchBoxScriptReady(scriptStateList);}}};ScriptObjectLoadCallback = function(index){scriptStateList[index].loadState = 'loaded';++loadedNumber;if (loadedNumber == totalNumber){WLSearchBoxScriptReady(scriptStateList);}};ScriptObjectErrorCallback = function(index){scriptStateList[index].loadState = 'error';++loadedNumber;if (loadedNumber == totalNumber){WLSearchBoxScriptReady(scriptStateList);}};try{window.detachEvent('onload', WLSearchLoadBootstrap);}catch (e){}};function WLSearchLoadBootstrap(){g_objWLBootstrap = new WLBootstrap();}try{window.attachEvent('onload', WLSearchLoadBootstrap);}catch (e){window.addEventListener('load', WLSearchLoadBootstrap, false);}